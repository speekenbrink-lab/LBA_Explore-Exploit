KalmanFilter <- function(oldQs,oldS, observedReward, cuesPres, walkSD, rewardSD){
  
  KGain <- (oldS[1:4] + walkSD ^ 2) / (oldS[1:4] + walkSD ^ 2 + rewardSD ^ 2)
  
  newQs <- oldQs + cuesPres * KGain * (observedReward - oldQs * cuesPres)
  
  newS <- (1 - cuesPres * KGain) * (oldS + walkSD ^ 2)
  
  outList = list(Qs = newQs, S = newS)
  
  return(outList)
}
  
  