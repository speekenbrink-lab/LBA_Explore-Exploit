#Simulate Sudden Uncertainty Onset
BanditSim <- function(params, trialNum = 500) {
  library('tidyverse')
  
  source('RW.R', TRUE)
  source('LBASim.R', TRUE)
  source('runBanditSimple.R', TRUE)
  
  #Set parameters (all in caps)
  #Start-point bound
  A <- params[1]
  #Threshold
  B <- params[2]
  #Decision Delay
  T0 <- params[3]
  #Standard Deviation
  SD_V <- params[4]
  #Learning Rate
  ALPHA <- params[5]
  #Starting values
  QSTART <- params[6]
  #Rate transformation from scores (Similar to a temperature parameter)
  PHI <- params[7]
  
  
  #Number of simulations
  simNum = 500
  
  #Optimality tracker
  simList <- matrix(ncol = simNum, nrow = trialNum)
  
  for (p in 1:simNum) {
    sim <- runBanditSimple(A, B, T0, SD_V, ALPHA, PHI, QSTART, trialNum)
    simList[1:trialNum, p] <- sim$optimal
  }
  
  condensedList <- apply(simList, 1, mean)
  
  condensedList <- data.frame(trial = 1:trialNum, averageScore = condensedList)
  
  ggplot(data = condensedList, mapping = aes(x = trial, y = averageScore, group = 1)) +
    geom_line() +
    coord_cartesian(ylim = c(.3, 1))
  
  return(condensedList)
}
