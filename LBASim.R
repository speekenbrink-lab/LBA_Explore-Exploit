#RT Decision model
LBASim <- function(A, B, T0, mean_v, SD_V, choiceNum) {#Simulate LBA model
  #n = number of participants
  #A = Starting point upper bound
  #b = threshold
  #t0 = start delay
  #mean_v = mean driftrate for each option
  #sd_v = mean standard deviation for each option
  
  #Simulate some trials
  
  choice <- 0
  rts <- 0
  sim <- 0
  
  trialFine <- 0
  while (!trialFine) {
    #Get Start point
    start <- runif(1, 0, A)
    drift <- 0
    time <- 0
    
    for (m in 1:choiceNum) {
      #Get Drift Rates
      drift[m] <- rnorm(1, mean_v[m], SD_V[m])
      
      if (drift[m] < 0) {
        drift[m] <- .01
      }
      
      #Get time to threshold
      time[m] <- (B - start) / drift[m]
      
      #Add non-decision time
      time[m] = time[m] + T0
    }
    
    #Check we don't have negative times (Make sure to change this to correspond to the number of choices available)
    if (sum(time > 0) == length(time)) {
      trialFine = 1
    }
  }
  
  #Make choice based on values
  choice <- which.min(time)
  rts <- min(time)
  
  sim <- data.frame(choice, rts)
  
  return(sim)
}