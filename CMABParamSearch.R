#Function to fit data from Uncertainty experiment
library('tidyverse')
library("R.matlab")
library('stats4')

  source('LBAFit.R', local = TRUE)
  source('LBApdf.R', TRUE)
  source('LBAcdf.R', TRUE)
  source('RW.R', TRUE)
  source('readData.R', TRUE)
  source('CMABFit.R')

cond = 1
pNum = 1
trialNum = 448
secOneTrialNum = 256 
secTwoTrialNum = 192
for (p in 1:pNum) {
  rawData <- readData(trialNum, secOneTrialNum, secTwoTrialNum, cond, p)
  
  # startPoint = c(.5, 3, .3, 1, .4, .1, 1)
  
  # mle(CMABFit(params = startPoint, rawData = rawData), start = list(params = startPoint), fixed = list('rawData'))
  # param <- optim(c(.5, 3, .3, 1, .4, .1, 1),fn = CMABFit, rawData = rawData, lower = c(0, .5, 0, .01, .05, 0, 1), 
  #                upper = c(10, 10, 10, 5, 1, 30, 10))
  param <- optim(c(.5, 3, .3, 1, .4, .1, 1),fn = CMABFit, rawData = rawData)
  
}

